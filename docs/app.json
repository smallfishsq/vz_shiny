[{"name":"app.R","content":"# app.R\n\n# Load required libraries\nlibrary(shiny)\n\n# Source the R code file\nsource(\"functions.R\", local = TRUE)\n\n\n# Define UI\nui <- fluidPage(\n  titlePanel(\"Cox Proportional Hazards Model Predictor\"),\n  sidebarLayout(\n    sidebarPanel(\n      sliderInput(\"input_age\", \"Input Age:\",\n                  min = min(surv_data$age), max = max(surv_data$age), value = median(surv_data$age)),\n      selectInput(\"input_gender\", \"Select Gender:\", choices = c(\"Male\", \"Female\"))\n#      actionButton(\"plot_button\", \"Plot\")\n    ),\n    mainPanel(\n      plotOutput(\"survival_plot\")\n    )\n  )\n)\n\n# Define server logic\nserver <- function(input, output) {\n  # Plot survival curve\n  output$survival_plot <- renderPlot({\n    new_data <- data.frame(age = input$input_age, gender = input$input_gender)\n    survfit(cox_model, newdata = new_data) %>%\n      ggsurvplot(data = surv_data, palette = \"Dark2\", conf.int = TRUE) +\n      ggtitle(\"Survival Curve with Confidence Interval\")\n  })\n}\n\n# Run the application\nshinyApp(ui = ui, server = server)","type":"text"},{"name":"functions.R","content":"# Load required libraries\nlibrary(survival)\nlibrary(survminer)\nlibrary(shiny)\n\n#Generate sample survival data with age and gender\n# set.seed(123)\n# n <- 100\n# age <- runif(n, 20, 80)\n# gender <- sample(c(\"Male\", \"Female\"), n, replace = TRUE)\n# time <- rexp(n, rate = 0.1)\n# status <- sample(0:1, n, replace = TRUE)\n# surv_data <- data.frame(time = time, status = status, age = age, gender = gender)\n# \n# write.csv(surv_data, \"surv_data.csv\", row.names = FALSE)\n\n# Fit Cox proportional hazards model\n\nurl <- \"https://raw.githubusercontent.com/smallfishsq/Test_RShiny/main/surv_data.csv\"\n\nsurv_data <- read.csv(url)\n\ncox_model <- coxph(Surv(time, status) ~ age + gender, data = surv_data)\n","type":"text"}]
